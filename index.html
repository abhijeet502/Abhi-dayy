<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Happy Birthday ‚Äî Abhi</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&family=Nunito:wght@300;700&display=swap" rel="stylesheet">
<style>
  :root{ --accent:#ff3b3b; --muted:#ffd6d6; --dark:#080308; }
  html,body{height:100%;margin:0;background: radial-gradient(closest-side at 50% 10%, rgba(255,0,0,0.06),transparent 40%), linear-gradient(180deg,#4b0303,#230000 50%); font-family:'Nunito',system-ui,Arial; color:#fff; -webkit-font-smoothing:antialiased;}
  /* background overlay uses pixabay CDN */
  body::before{
    content:""; position:fixed; inset:0;
    background-image:url('https://cdn.pixabay.com/photo/2016/11/19/17/20/spider-web-1845492_1280.png');
    background-repeat:no-repeat; background-position:center top; background-size:cover; opacity:0.12; pointer-events:none; filter:grayscale(8%) contrast(.9);
  }

  .wrap{max-width:880px;margin:20px auto;padding:16px;}
  .card{background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.28)); border-radius:22px; padding:22px; border:2px solid rgba(255,0,0,0.14); box-shadow: 0 18px 48px rgba(0,0,0,0.6); position:relative; overflow:visible}

  .spider{position:fixed; width:70px; height:70px; z-index:5; pointer-events:none; opacity:0.95; filter: drop-shadow(0 10px 30px rgba(0,0,0,0.6));}
  .sp1{ left:8%; top:8%; transform:translateY(-10px); animation:floaty 6s ease-in-out infinite;}
  .sp2{ right:6%; top:6%; width:86px; height:86px; animation:floaty 7s ease-in-out infinite reverse;}
  .sp3{ left:4%; bottom:8%; width:60px;height:60px; animation:floaty 8s ease-in-out infinite;}
  @keyframes floaty { 0%{transform:translateY(0)} 50%{transform:translateY(18px)} 100%{transform:translateY(0)} }

  .title{font-weight:800;color:var(--accent);font-size:30px;text-align:center;margin:8px 0; letter-spacing:0.6px;}
  .glitch { display:inline-block; position:relative; color:var(--accent); font-weight:900; }
  .glitch::before, .glitch::after{ content:attr(data-text); position:absolute; left:0; top:0; width:100%; opacity:.8; }
  .glitch::before{ transform:translate(-2px, -1px); color:#ff9b9b; mix-blend-mode:screen; opacity:.7; animation:glitch-anim-1 2.2s infinite linear; }
  .glitch::after{ transform:translate(2px, 1px); color:#ffffff; mix-blend-mode:overlay; opacity:.5; animation:glitch-anim-2 2.6s infinite linear; }
  @keyframes glitch-anim-1 { 0%,10%{clip-path:inset(0)} 11%{clip-path:inset(20% 0 60% 0)} 12%{clip-path:inset(0)} 50%{clip-path:inset(50% 0 10% 0)} 90%{clip-path:inset(0)} }
  @keyframes glitch-anim-2 { 0%,20%{clip-path:inset(0)} 21%{clip-path:inset(10% 0 50% 0)} 22%{clip-path:inset(0)} 70%{clip-path:inset(30% 0 20% 0)} 100%{clip-path:inset(0)} }

  .hero-row{display:flex;gap:14px;align-items:center;justify-content:center;margin:18px 0;}
  .hero-img{width:86px;height:86px;border-radius:14px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.22)); display:flex;align-items:center;justify-content:center; overflow:hidden; border:2px solid rgba(255,0,0,0.08);}
  .hero-img img{width:100%;height:100%;object-fit:cover}

  .content{background:linear-gradient(180deg, rgba(0,0,0,0.12), rgba(0,0,0,0.22)); padding:16px;border-radius:12px;color:#ffeaea; line-height:1.65; font-size:15px;}
  .cta{display:flex;gap:12px;justify-content:center;margin-top:18px}
  .btn{background:linear-gradient(180deg,var(--accent),#c21b1b); padding:14px 26px;border-radius:999px;border:none;color:white;font-weight:800;cursor:pointer; box-shadow: 0 14px 28px rgba(199,27,27,0.22)}
  .ghost{background:transparent;border:1px solid rgba(255,255,255,0.08);padding:10px 16px;color:#ffbdbd;border-radius:12px}

  .letter{margin-top:14px;background:linear-gradient(180deg,#05030a,#0b0810); border-radius:16px;padding:18px;border:1px solid rgba(255,0,0,0.06)}
  .letter h3{color:#ff9a9a;margin:6px 0 6px;font-weight:800}
  .letter p{color:#e8dede;margin:6px 0}

  .envelope{display:flex;align-items:center;justify-content:center;padding:22px;border-radius:14px;background:#05060a; margin-top:16px; cursor:pointer; border:1px solid rgba(255,0,0,0.06);}
  .envelope img{width:260px;max-width:74%}

  .cake-wrap{display:flex;flex-direction:column;gap:12px;align-items:center;justify-content:center;padding:18px}
  .cake{font-size:84px; cursor:pointer; display:inline-block; user-select:none; transition:transform .12s ease}
  .cake:active{ transform:translateY(2px) }
  .flames{display:inline-block;margin-left:8px; transition:opacity .28s ease, transform .28s ease}
  .flames.lit{opacity:1; transform:translateY(0)}
  .flames.out{opacity:0; transform:translateY(-12px) scale(.9)}

  .smoke{position:relative;width:160px;height:120px; pointer-events:none;}
  .puff{position:absolute;left:50%;transform:translateX(-50%);top:56px;font-size:28px;opacity:0; filter:blur(0)}
  .puff.animate{ animation:puffUp .9s ease forwards; }
  @keyframes puffUp { 0%{ transform:translate(-50%,0) scale(.4); opacity:.9; filter:blur(0) } 100%{ transform:translate(-50%,-120px) scale(1.5); opacity:0; filter:blur(6px) } }

  .confetti-piece{ position:fixed; width:10px; height:14px; pointer-events:none; z-index:9999; opacity:1; border-radius:2px; transform-origin:center; }

  .credit{ text-align:center; color:#ffdede; margin-top:12px; font-weight:700 }

  @media (max-width:540px){
    .title{font-size:22px}
    .card{padding:16px}
    .hero-img{width:64px;height:64px}
    .cake{font-size:64px}
    .envelope img{width:220px}
  }
</style>
</head>
<body>

  <!-- floating decorative spiders (CDN image used) -->
  <img src="https://cdn.pixabay.com/photo/2021/02/08/12/20/superhero-5995702_1280.png" class="spider sp1" alt="spider dec">
  <img src="https://cdn.pixabay.com/photo/2021/02/08/12/20/superhero-5995702_1280.png" class="spider sp2" alt="spider dec">
  <img src="https://cdn.pixabay.com/photo/2021/02/08/12/20/superhero-5995702_1280.png" class="spider sp3" alt="spider dec">

  <div class="wrap">

    <!-- PAGE 1 -->
    <section id="page1" class="card" style="display:block">
      <div style="text-align:center">
        <div class="title"><span class="glitch" data-text="üï∑Ô∏è Happy Birthday, Hero!">üï∑Ô∏è Happy Birthday, Hero!</span></div>
        <div style="color:#ffdede;font-weight:700;margin-bottom:4px">From my heart to my favourite hero ‚Äî <strong>Abhi</strong></div>
      </div>

      <div class="hero-row">
        <div class="hero-img" title="Decoration">
          <img src="https://cdn.pixabay.com/photo/2021/02/08/12/20/superhero-5995702_1280.png" alt="hero left">
        </div>

        <div style="flex:1">
          <div class="content">In every universe you'd still be the one saving the day. Today we celebrate the real superhero of this story ‚Äî <strong>you</strong>. Ready to swing into your birthday surprise? Click below.</div>
        </div>

        <div class="hero-img">
          <img src="https://cdn.pixabay.com/photo/2021/02/08/12/20/superhero-5995702_1280.png" alt="hero right">
        </div>
      </div>

      <div class="cta">
        <button class="btn" onclick="showPage(2)">Swing In!</button>
        <button class="ghost" onclick="toggleMusic()">üîä Music</button>
      </div>

      <div style="text-align:center;margin-top:10px;color:#ffdede">Crafted with great power & responsibility ‚Äî <strong>Abhi</strong></div>
    </section>

    <!-- PAGE 2 -->
    <section id="page2" class="card" style="display:none">
      <h2 style="text-align:center;color:#ffb3b3">A Spider-Verse Birthday Letter üï∏Ô∏èüíå</h2>
      <p style="text-align:center;color:#ffdede;margin-top:0">Straight from Abhi's heart to the birthday hero</p>

      <div class="letter">
        <div style="display:flex;align-items:center;justify-content:space-between;">
          <div style="display:flex;align-items:center;gap:12px">
            <div style="width:46px;height:46px;border-radius:10px;overflow:hidden"><img src="https://cdn.pixabay.com/photo/2021/02/08/12/20/superhero-5995702_1280.png" style="width:100%;height:100%;object-fit:cover"></div>
            <div style="font-weight:800;color:#ff9a9a">To my Birthday Hero</div>
          </div>
          <img src="https://cdn.pixabay.com/photo/2021/02/08/12/20/superhero-5995702_1280.png" style="width:70px;height:70px">
        </div>

        <h3 style="margin-top:12px;color:#ff9a9a">My dearest birthday hero,</h3>
        <p>Today marks another year of your incredible existence, and I couldn‚Äôt be more grateful to be part of your story. You don‚Äôt need a mask or a suit to be a hero ‚Äî the way you care, smile, and show up for the people you love already makes your world safer and brighter.</p>
        <p>You bring your own kind of superpower into every room you walk into: your laugh, your chaos, your softness, your strength. You deserve every happy universe, every peaceful night, every dream you‚Äôre secretly chasing.</p>
        <p>On this day, I just want you to know: no matter how many timelines or realities there are, I would still choose this one ‚Äî the one where I get to celebrate <strong>you</strong>.</p>

        <div style="display:flex;align-items:center;justify-content:space-between;margin-top:12px">
          <div style="color:#ffdede;font-weight:600">Made with ‚ù§Ô∏è for your special day</div>
          <div style="text-align:right;color:#ff9a9a;font-weight:800">Forever on your side,<br><span style="font-size:16px;color:#ffdce0">Abhi üíñüï∑Ô∏è</span></div>
        </div>
      </div>

      <div style="display:flex;gap:10px;justify-content:center;margin-top:14px">
        <button class="btn" onclick="showPage(3)">Continue It ‚ú®</button>
        <button class="ghost" onclick="showPage(1)">Back</button>
      </div>
    </section>

    <!-- PAGE 3 -->
    <section id="page3" class="card" style="display:none">
      <h2 style="text-align:center;color:#ffb3b3">A Spider-Special Delivery</h2>
      <p style="text-align:center;color:#ffdede">Click the envelope to open your birthday transmission</p>

      <div class="envelope" onclick="openEnvelope()">
        <img id="envelopeImg" src="https://cdn.pixabay.com/photo/2016/03/31/20/59/envelope-1292835_1280.png" alt="envelope">
      </div>

      <div style="display:flex;gap:8px;justify-content:center;margin-top:12px">
        <button class="btn" onclick="openEnvelope()">Open</button>
        <button class="ghost" onclick="showPage(2)">Back</button>
      </div>
    </section>

    <!-- PAGE 4 -->
    <section id="page4" class="card" style="display:none">
      <h2 style="text-align:center;color:#ffb3b3">Make a Wish ‚Äî Blow the Candles Out</h2>
      <p style="text-align:center;color:#ffdede">Tap the cake OR use your mic to blow (allow microphone)</p>

      <div class="cake-wrap">
        <div id="cakeBtn" class="cake" onclick="tryExtinguish(true)" title="Tap to blow candles">üéÇ
          <span id="flames" class="flames lit">üî•üî•üî•</span>
        </div>

        <div class="smoke" id="smoke">
          <div id="p1" class="puff">üí®</div>
          <div id="p2" class="puff">üí®</div>
          <div id="p3" class="puff">üí®</div>
        </div>

        <div style="display:flex;gap:10px;justify-content:center">
          <button class="btn" onclick="startListen()">Blow with mic</button>
          <button class="ghost" onclick="resetCandles()">Reset</button>
          <button class="ghost" onclick="showPage(1)">Home</button>
        </div>

        <div style="text-align:center;color:#ffdede;margin-top:8px">Tip: On phones, place mic near your mouth and blow gently into it.</div>
      </div>

      <div class="credit">Made with ‚ù§Ô∏è by <strong>Abhi</strong></div>
    </section>

  </div>

<!-- optional audio (CDN not used by default) -->
<audio id="bgm" loop></audio>

<script>
  // navigation helper: show page 1..4
  function showPage(n){
    const cards = document.querySelectorAll('.wrap > section.card');
    cards.forEach((c, idx) => c.style.display = (idx === (n-1) ? 'block' : 'none'));
    window.scrollTo({top:0, behavior:'smooth'});
  }

  function openEnvelope(){
    const env = document.getElementById('envelopeImg');
    env.style.transition = 'transform .8s ease, opacity .6s';
    env.style.transform = 'rotateY(180deg) scale(.96)';
    env.style.opacity = '0.95';
    setTimeout(()=> showPage(4), 850);
  }

  function toggleMusic(){
    const bgm = document.getElementById('bgm');
    if(!bgm.src || bgm.src === "") { alert('No ambient track provided. Add one by setting bgm.src to a URL if you want music.'); return; }
    if(bgm.paused){ bgm.play().catch(()=>{}); alert('Music started'); }
    else{ bgm.pause(); alert('Music paused'); }
  }

  /* Cake logic */
  let candlesLit = true;
  function tryExtinguish(byClick){
    if(!candlesLit) return;
    extinguish(byClick);
  }

  function extinguish(byClick){
    candlesLit = false;
    const flames = document.getElementById('flames');
    flames.classList.remove('lit'); flames.classList.add('out');

    try{ const pop = new Audio(); pop.src = ''; pop.play().catch(()=>{}); }catch(e){}

    const p1 = document.getElementById('p1'), p2 = document.getElementById('p2'), p3 = document.getElementById('p3');
    [p1,p2,p3].forEach((p, i)=> {
      setTimeout(()=> { p.classList.add('animate'); }, 80 + i*140);
      setTimeout(()=> { p.classList.remove('animate'); }, 1000 + i*120);
    });

    burstConfetti();

    setTimeout(()=> {
      try{ navigator.vibrate && navigator.vibrate(120); }catch(e){}
      alert('Candles out! Make a wish ‚ú®');
    }, 900);
  }

  function resetCandles(){
    candlesLit = true;
    const flames = document.getElementById('flames');
    flames.classList.remove('out'); flames.classList.add('lit');
  }

  function burstConfetti(){
    const colors = ['#ff4b4b','#ffd24b','#8aff8a','#4bafff','#d57bff'];
    for(let i=0;i<30;i++){
      const el = document.createElement('div');
      el.className = 'confetti-piece';
      el.style.background = colors[Math.floor(Math.random()*colors.length)];
      el.style.left = (50 + (Math.random()*60 - 30)) + '%';
      el.style.top = (20 + Math.random()*10) + '%';
      el.style.width = (6 + Math.random()*12)+'px';
      el.style.height = (8 + Math.random()*14)+'px';
      el.style.transform = `translate3d(0,-20vh,0) rotate(${Math.random()*360}deg)`;
      document.body.appendChild(el);
      const tx = (Math.random()*160 - 80);
      el.animate([
        { transform: `translate3d(0,-30vh,0) rotate(0deg)`, opacity:1 },
        { transform: `translate3d(${tx}px, 70vh,0) rotate(${360 + Math.random()*540}deg)`, opacity:1 }
      ], { duration: 1200 + Math.random()*700, easing: 'cubic-bezier(.2,.8,.2,1)' });
      setTimeout(()=> el.remove(), 1600 + Math.random()*900);
    }
  }

  /* Mic blow detection */
  let audioContext, analyser, sourceNode, dataArray, listening=false;
  async function startListen(){
    if(listening) return alert('Already listening for blow...');
    try{
      const stream = await navigator.mediaDevices.getUserMedia({ audio:true });
      audioContext = new (window.AudioContext || window.webkitAudioContext)();
      analyser = audioContext.createAnalyser();
      analyser.fftSize = 2048;
      sourceNode = audioContext.createMediaStreamSource(stream);
      sourceNode.connect(analyser);
      dataArray = new Uint8Array(analyser.fftSize);
      listening = true;
      monitorBlow(stream);
      setTimeout(()=> stopListening(stream), 8000);
    }catch(err){
      console.error(err);
      alert('Microphone access denied or not available.');
    }
  }

  function stopListening(stream){
    listening = false;
    try{ if(stream && stream.getTracks) stream.getTracks().forEach(t=>t.stop()); if(sourceNode) sourceNode.disconnect(); if(audioContext) audioContext.close().catch(()=>{}); }catch(e){}
  }

  function monitorBlow(stream){
    let consecutive = 0; const needed = 3; const threshold = 15;
    const loop = ()=>{
      if(!listening) return;
      analyser.getByteTimeDomainData(dataArray);
      let sum=0;
      for(let i=0;i<dataArray.length;i++){ const v = dataArray[i] - 128; sum += v*v; }
      const rms = Math.sqrt(sum / dataArray.length);
      if(rms > threshold){
        consecutive++;
        if(consecutive >= needed){
          extinguish(false);
          stopListening(stream);
          return;
        }
      } else consecutive = Math.max(0, consecutive-1);
      requestAnimationFrame(loop);
    };
    loop();
  }

  // init: show first page
  (function init(){ showPage(1); })();

  // small click hint on floating spiders
  document.addEventListener('click', (e)=>{
    const t = e.target;
    if(t.classList && t.classList.contains('spider')) alert('Decoration: image loaded from CDN. To replace, edit the HTML image src.');
  });

</script>
</body>
</html>
