<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Letter ‚Äî Abhi</title>

<!-- Styles: envelope teaser + animated letter + typing -->
<style>
  :root{
    --bg1:#5b0b0b;
    --bg2:#1f0606;
    --accent1:#ff3a3a;
    --accent2:#ff7b7b;
    --muted:#c9bfc6;
  }

  html,body{
    height:100%;
    margin:0;
    font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    background: linear-gradient(180deg,var(--bg1),var(--bg2));
    color:#fff;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
  }

  /* faint web background like other pages */
  body::before{
    content:"";
    position:fixed;
    inset:0;
    background: url('assets/web.png') center/cover no-repeat;
    opacity:.07;
    filter: blur(2px) saturate(.9);
    z-index:0;
    pointer-events:none;
  }

  .wrap{
    min-height:100vh;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:28px;
    z-index:2;
    position:relative;
  }

  .stage{
    width:100%;
    max-width:720px;
  }

  /* Card container (hidden until envelope opens) */
  .card{
    margin:0 auto;
    border-radius:18px;
    padding:22px;
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.6));
    border:1px solid rgba(255,255,255,0.04);
    box-shadow: 0 30px 90px rgba(0,0,0,0.65);
    overflow:hidden;
  }

  h2{
    margin:0 0 8px 0;
    color: var(--accent2);
    font-weight:900;
    font-size:22px;
    text-align:center;
  }

  .subtitle{
    text-align:center;
    color:var(--muted);
    margin-bottom:12px;
  }

  /* Envelope teaser (center) */
  .env-wrap{
    display:flex;
    align-items:center;
    justify-content:center;
    margin:18px 0 14px;
  }
  .env{
    width:260px;
    height:260px;
    border-radius:14px;
    background: linear-gradient(180deg,#ffffff 0%, #fff 100%);
    display:flex;
    align-items:center;
    justify-content:center;
    box-shadow: 0 22px 60px rgba(0,0,0,0.6);
    cursor:pointer;
    overflow:hidden;
    transform-origin:center;
  }
  .env img{ width:82%; height:82%; object-fit:cover; border-radius:12px; display:block }

  .hint{
    text-align:center;
    color:#d7c5cb;
    margin-top:10px;
  }

  /* Hidden letter area that will animate in */
  .letter{
    margin-top:18px;
    border-radius:12px;
    padding:18px;
    background: linear-gradient(180deg, rgba(0,0,0,0.85), rgba(6,6,8,0.95));
    border:1px solid rgba(255,255,255,0.03);
    color:#f1dfe2;
    line-height:1.6;
    font-size:15px;
    display:none;
  }

  .letter h3{
    margin:0 0 8px 0;
    color:#ffb2b2;
    font-size:20px;
    text-align:left;
  }

  .letter .para{
    min-height:36px;
    overflow:visible;
    white-space:pre-wrap;
    margin-bottom:12px;
    opacity:0;
  }

  .letter .sig{ text-align:right; font-weight:800; margin-top:6px; color:#ffdfe6; opacity:0; }

  .actions{
    display:flex;
    justify-content:center;
    gap:12px;
    margin-top:16px;
  }

  .btn{
    padding:12px 18px;
    border-radius:999px;
    border:none;
    font-weight:800;
    cursor:pointer;
  }
  .btn.primary{ background: linear-gradient(90deg,var(--accent1),var(--accent2)); color:#111; box-shadow:0 12px 36px rgba(255,60,60,0.12) }
  .btn.ghost{ background:transparent; color:#f0dfe0; border:1px solid rgba(255,255,255,0.05) }

  /* small little envelope flap graphic (decor) */
  .flap{
    position:absolute;
    right:28px;
    top:18px;
    width:46px;height:46px;
    opacity:0.9;
    filter:drop-shadow(0 6px 12px rgba(0,0,0,0.4));
  }

  @media (max-width:520px){
    .env{ width:200px; height:200px; }
    .stage{ padding:0 12px; }
  }
</style>
</head>
<body>

  <div class="wrap">
    <div class="stage">

      <!-- card container -->
      <div class="card" role="main" aria-label="Birthday letter stage">

        <h2>A Spider-Verse Birthday Letter <span aria-hidden="true">üï∑Ô∏è</span></h2>
        <div class="subtitle">From my heart to my favourite hero</div>

        <!-- envelope teaser -->
        <div class="env-wrap">
          <div id="env" class="env" role="button" aria-pressed="false" aria-label="Open envelope">
            <!-- use your album-art as envelope preview ‚Äî keeps your existing asset -->
            <img id="envImg" src="assets/album-art.png" alt="envelope preview / card art">
          </div>
        </div>

        <div class="hint">Click the envelope to open your birthday transmission.</div>

        <!-- the real letter (initially hidden) -->
        <div id="letter" class="letter" aria-hidden="true">
          <h3 id="letterTitle">To my Birthday Hero</h3>

          <div id="p1" class="para"></div>
          <div id="p2" class="para"></div>
          <div id="p3" class="para"></div>

          <div id="sig" class="sig"></div>

          <div class="actions" aria-hidden="false">
            <button id="toPlaylist" class="btn primary">Continue to Playlist</button>
            <button id="backHome" class="btn ghost">Back</button>
          </div>
        </div>

      </div>

    </div>
  </div>

<!-- GSAP (for envelope open + subtle motion) -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>

<script>
(function(){
  // content to type (you said inspired by the other letter ‚Äî I used warm copy; change text if you want)
  const content = {
    p1: "Today marks another year of your incredible existence, and I couldn't be more grateful to be part of your story. You don't need a mask or a suit to be a hero ‚Äî the way you care, laugh, and show up for people already makes your world brighter.",
    p2: "You bring your own kind of superpower into every room you enter: your warmth, your chaos, your quiet strength. You deserve every happy universe, every peaceful night, and every dream you're secretly chasing.",
    p3: "On this day, I just want you to know: no matter how many timelines or realities there are, I would still choose this one ‚Äî the one where I get to celebrate you."
  };
  const signature = "Forever on your side,\nAbhi üíñüï∑Ô∏è";

  const env = document.getElementById('env');
  const envImg = document.getElementById('envImg');
  const letter = document.getElementById('letter');
  const p1 = document.getElementById('p1');
  const p2 = document.getElementById('p2');
  const p3 = document.getElementById('p3');
  const sig = document.getElementById('sig');
  const toPlaylist = document.getElementById('toPlaylist');
  const backHome = document.getElementById('backHome');

  // typing helper
  function typeText(el, text, charDelay=25){
    return new Promise(resolve=>{
      el.textContent = "";
      el.style.opacity = 1;
      let i=0;
      function step(){
        if(i < text.length){
          el.textContent += text.charAt(i);
          i++;
          // slightly slower for punctuation to look natural
          const nextDelay = (/[.,!?\n]/.test(text.charAt(i))) ? charDelay * 6 : charDelay;
          setTimeout(step, nextDelay);
        } else {
          resolve();
        }
      }
      step();
    });
  }

  // envelope open animation sequence
  env.addEventListener('click', async function openEnvelope(){
    // disable further clicks
    env.setAttribute('aria-pressed','true');
    env.style.pointerEvents = 'none';

    // small press animation
    await gsap.to(env, { scale: 0.94, duration: 0.12, ease: "power1.out" });

    // "flip / open" envelope visual:
    // 1) scale up slightly and rotate Z to add drama
    // 2) fade out env image and reveal letter panel
    const tl = gsap.timeline();
    tl.to(env, { rotationY: 40, duration: 0.28, ease: "power2.out" }, 0);
    tl.to(env, { rotationX: -8, y: -18, duration: 0.45, ease:"power2.out" }, 0);
    tl.to(env, { autoAlpha: 0, duration: 0.25 }, 0.36);

    // after env fades, show letter container
    await tl.then();

    // reveal letter container with pop
    letter.style.display = 'block';
    letter.setAttribute('aria-hidden','false');
    gsap.fromTo(letter, { y: 18, autoAlpha: 0, scale: 0.98 }, { y:0, autoAlpha:1, scale:1, duration:0.6, ease:"elastic.out(1,0.6)" });

    // small background pulse while typing begins
    gsap.to(document.body, { backgroundPosition: '0 0', duration: 0.1 });

    // type paragraphs in sequence
    await typeText(p1, content.p1, 18);
    await new Promise(r=> setTimeout(r, 260));
    await typeText(p2, content.p2, 18);
    await new Promise(r=> setTimeout(r, 260));
    await typeText(p3, content.p3, 18);
    await new Promise(r=> setTimeout(r, 380));
    await typeText(sig, signature, 24);

    // small glow on the continue button to draw attention
    gsap.fromTo(toPlaylist, { boxShadow: '0 0 0 rgba(0,0,0,0)' }, { boxShadow: '0 16px 48px rgba(255,80,80,0.18)', duration: 0.6, yoyo:true, repeat:1 });
  }, { once:true });

  // actions
  toPlaylist.addEventListener('click', ()=> location.href = 'page5.html');
  backHome.addEventListener('click', ()=> history.back());

  // keyboard accessibility: Enter opens envelope
  env.addEventListener('keydown', (e) => { if(e.key === 'Enter' || e.key === ' ') env.click(); });

  // Respect reduced motion preference
  if (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
    // disable animations: show letter immediately (no typing)
    env.addEventListener('click', () => {
      env.style.display = 'none';
      letter.style.display = 'block';
      p1.textContent = content.p1;
      p2.textContent = content.p2;
      p3.textContent = content.p3;
      sig.textContent = signature;
      letter.setAttribute('aria-hidden','false');
    }, { once:true });
  }
})();
</script>
</body>
</html>
